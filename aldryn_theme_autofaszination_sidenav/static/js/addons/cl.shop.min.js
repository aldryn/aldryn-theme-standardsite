window.Cl=window.Cl||{},Cl.Shop={},function(t){"use strict";Cl.Shop.Sort=new Class({initialize:function(i){this.form=t(i),this.elements=this.form.find(".sort input"),this._setup()},_setup:function(){var i=this;this.elements.on("change",function(n){n.preventDefault(),i.form.find(".sort").removeClass("active"),t(this).closest(".sort").addClass("active"),new Cl.Shop.Ajax({form:i.form})})}}),Cl.Shop.Filter=new Class({initialize:function(i){this.form=t(i),this.triggers=this.form.find(".trigger"),this.containers=this.form.find(".container"),this.elements=this.form.find(".container input"),this._setup()},_setup:function(){var i=this,n=300;this.containers.each(function(){t(this).closest("li").hasClass("expanded")&&i.containers.eq(i.containers.index(this)).show()}),this.triggers.on("click",function(t){t.preventDefault(),i.containers.eq(i.triggers.index(this)).toggle(n).closest("li").toggleClass("expanded")}),this.elements.on("change",function(){new Cl.Shop.Ajax({form:i.form})})}}),Cl.Shop.Pagination=new Class({initialize:function(i){this.container=t(i),this._setup()},_setup:function(){var i=this;this.container.delegate("#form-product-pagination a","click",function(n){n.preventDefault(),i._change(t(this))})},_change:function(t){var i=t.attr("href").replace("?page=",""),n=t.closest("form"),s=n.find("#page-number");s.val(i),new Cl.Shop.Ajax({form:n})}}),Cl.Shop.Tabs=new Class({initialize:function(i,n){this.nav=t(i),this.containers=t(n),this.triggers=this.nav.find("a"),this.triggerParents=this.nav.find("li"),this._setup()},_setup:function(){var t=this;this.nav.show(),this.containers.hide().eq(0).show(),this.triggers.on("click",function(i){i.preventDefault();var n=t.triggers.index(this);t.triggerParents.removeClass("active").eq(n).addClass("active"),t.containers.hide().eq(n).show()})}}),Cl.Shop.Ajax=new Class({initialize:function(i){this.form=i.form,this.container=t("#product-container"),this.pagination=t(".pagenav"),this.loader=t("#product-loader"),this.params="",this.forms={pagination:t("#form-product-pagination"),sorting:t("#form-product-sorting"),filters:t("#form-product-filters")},this._setup()},_setup:function(){var i=this;this.loader.show(),t.each(this.forms,function(t,n){n.serialize()&&(i.params+="&"+n.serialize())}),this.params=this.params.replace("&","?"),this._ajax()},_ajax:function(){var i=this,n=300;t.ajax({type:"GET",url:this.form.attr("action"),dataType:"html",data:this.params.replace("?","")+"&ajax=1",success:function(t){i.container.hide().fadeIn(n).html(t),window.history&&history.replaceState(null,"Shop",i.params)},error:function(){window.location.reload()}})}})}(jQuery);